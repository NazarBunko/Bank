<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аналітика</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="sidebar/analytics.css" />
</head>
<body>

<div class="form-container">
    <button class="close-button" aria-label="Закрити форму" onclick="window.location.href='/dashboard'">&#10005;</button>
    <!-- Ліва форма (графік витрат) -->
    <div class="chart-container">
        <h3>Витрати</h3>
        <div id="expensesChart"></div>
    </div>

    <!-- Права форма (графік депозитів) -->
    <div class="chart-container">
        <h3>Депозити</h3>
        <div id="depositsChart"></div>
    </div>
</div>

<script>
    // Отримуємо дані з Thymeleaf
    const expensesData = [[${expenses}]]; // Переконайтеся, що дані правильні
    const depositsData = [[${deposits}]]; // Переконайтеся, що дані правильні

    console.log('Expenses:', expensesData);
    console.log('Deposits:', depositsData);

    // Дати для графіків (можна змінити відповідно до ваших даних)
    const dates = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26'];

    // Створення графіків за допомогою Plotly
    function renderPlotlyChart(elementId, data, label, color) {
        const trace = {
            x: dates,
            y: data,
            type: 'bar',  // Встановлюємо тип графіка на гістограму
            name: label,
            marker: {
                color: color, // Використовуємо колір, переданий у функцію
                opacity: 0.7, // Прозорість
                line: {
                    color: color, // Колір обводки стовпців
                    width: 2
                }
            }
        };

        const layout = {
            title: label,
            xaxis: {title: 'Дати'},
            yaxis: {title: label},
            showlegend: true,
            barmode: 'group',  // Групуємо стовпці по мітках
            xaxis: {
                tickangle: -45  // Поворот підписів осі X
            },
            yaxis: {
                showgrid: true,
                zeroline: true
            },
            staticPlot: true  // Забороняє маніпуляції з графіком
        };

        Plotly.newPlot(elementId, [trace], layout);
    }

    // Рендеринг графіків для витрат і депозитів з різними кольорами
    renderPlotlyChart('expensesChart', expensesData, 'Витрати', 'rgb(255, 87, 51)');  // Колір для витрат
    renderPlotlyChart('depositsChart', depositsData, 'Депозити', 'rgb(33, 150, 243)');  // Колір для депозитів
</script>

</body>
</html>
